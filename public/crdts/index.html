<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0"
    />
    <title>Crdt</title>
    <meta property="og:title" content="Crdt" />
    <meta charset="utf-8" />
    <meta property="og:type" content="article" />

    <meta property="og:description" content="Short description of your project" />
    <meta property="description" content="Short description of your project" />

    <link rel="stylesheet" href="static/idyll_styles.css" />
  </head>
  <body>
    <div id="idyll-mount"><div data-reactroot=""><div class="idyll-root"><div class=" idyll-text-container"></div><div class="article-header" style="background:#222222;color:#ffffff"><h1 class="hed">CRDTs</h1><h2 class="dek">Conflict-free Replicated Data Types and collaboration</h2><div class="byline">By: <a href="https://coltonpierson.com">Colton Pierson</a></div><div class="idyll-pub-date">Wed Apr 08 2020</div></div><div class=" idyll-text-container"><h1 id="so-what-is-a-crdt">So what is a CRDT</h1><p>CRDTs (Conflict-free Replicated Data Type)s enable eventual consistency.
As multiple instances of them are either merged or their operations are
evaluated, they will always resolve to a consistent final state.
Theyâ€™re often used in distributed systems or for other collaborative applications.</p><h1 id="a-simple-crdt-(2p-set)">A Simple CRDT (<!-- -->2<!-- -->P-Set)</h1><h2 id="a-grocery-list">A Grocery List</h2><p>Weâ€™re going to use a grocery list as an approximation of a set.
Try adding or remove items from your list.</p><span class="aside-container"><span class="aside"><caption>Your Events</caption><div class="flex flex-row items-stretch"><div class="mt-2"><div class="flex flex-row flex-wrap"><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‡</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‰</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">removed</span><span class="text-xl">ğŸ‰</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ¥‘</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸŒ</span></div></div></div></div></span></span><div class="mt-6"><span class="border rounded p-1 m-1">+<!-- -->ğŸ‡</span><span class="border rounded p-1 m-1">+<!-- -->ğŸˆ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ‰</span><span class="border rounded p-1 m-1">+<!-- -->ğŸŒ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ¥‘</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ¥¦</span>time@<!-- -->5<div class="m-2 border border-gray-400 rounded p-2"><span class="text-3xl">ğŸ‡</span><span class="text-3xl">ğŸŒ</span><span class="text-3xl">ğŸ¥‘</span></div></div><p>Weâ€™re going to use some timelines to play around
when events occur. Press play to see the series of changes to your
grocery list take place. Everything will resolve to the same state you see above.</p><div style="width:100%"></div><div class="w-64"><div class="pl-2">time@<!-- -->5</div><div class="m-2 border border-gray-400 rounded p-2 h-16"><span class="text-3xl">ğŸ‡</span><span class="text-3xl">ğŸŒ</span><span class="text-3xl">ğŸ¥‘</span></div></div><h2 id="a-friend">A Friend</h2><span class="aside-container"><span class="aside"><caption>Your Friendâ€™s Events</caption><div class="flex flex-row items-stretch"><div class="mt-2"><div class="flex flex-row flex-wrap"><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ¥¦</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">removed</span><span class="text-xl">ğŸ‡</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‰</span></div></div></div></div></span></span><p>This is going to be a friend of yourâ€™s editing the same grocery
list at around the same time.</p><div class="mt-6"><span class="border rounded p-1 m-1">+<!-- -->ğŸ‡</span><span class="border rounded p-1 m-1">+<!-- -->ğŸˆ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ‰</span><span class="border rounded p-1 m-1">+<!-- -->ğŸŒ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ¥‘</span><span class="border rounded p-1 m-1">+<!-- -->ğŸ¥¦</span>time@<!-- -->3<div class="m-2 border border-gray-400 rounded p-2"><span class="text-3xl">ğŸ‰</span><span class="text-3xl">ğŸ¥¦</span></div></div><p>We can scrub through each of their events taking place as well:</p><div style="width:100%"></div><div class="w-64"><div class="pl-2">time@<!-- -->5</div><div class="m-2 border border-gray-400 rounded p-2 h-16"><span class="text-3xl">ğŸ‰</span><span class="text-3xl">ğŸ¥¦</span></div></div><h2 id="a-conflict">A Conflict</h2><span class="aside-container"><span class="aside"><caption>Comparing Our Events</caption><div class="flex flex-row items-stretch"><div class="mt-2"><button class="border p-1 ml-2 rounded border-gray-400"> Shuffle </button><div class="flex flex-row flex-wrap"><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‡</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‰</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">removed</span><span class="text-xl">ğŸ‰</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ¥‘</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸŒ</span></div></div></div><div class="mt-2"><button class="border p-1 ml-2 rounded border-gray-400"> Shuffle </button><div class="flex flex-row flex-wrap"><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ¥¦</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">removed</span><span class="text-xl">ğŸ‡</span></div><div class="m-2 border-2 border-gray-400 rounded p-2 flex justify-between content-end border-blue-400 bg-blue-200"><span class="text-xl">added</span><span class="text-xl">ğŸ‰</span></div></div></div></div></span></span><p>Lets take a look at what happens when donâ€™t use something like a CRDT.
If events take place in different orders, weâ€™ll get different results. Try
hitting the <em>shuffle</em> button to mix up the order our events take place in.</p><div class="mt-6"><div class="pl-2">timeA@<!-- -->5<!-- --> timeB@<!-- -->5</div><div class="flex flex-row"><div class="w-1/2 m-2 border border-gray-400 rounded p-2"><span class="text-3xl">ğŸ‰</span><span class="text-3xl">ğŸŒ</span><span class="text-3xl">ğŸ¥‘</span><span class="text-3xl">ğŸ¥¦</span></div></div></div><p>We get different results for different orders of operations.</p><h2 id="conflict-free">Conflict-free</h2><p>In contrast, using the CRDT structure fixes this.
No matter what order all of the events occur, the final state of our list will
be the same. This is the goal of eventual consistency. Everything is
deterministic, anything can happen in any order but we get the same result.</p><div class="mt-6"><div class="pl-2">timeA@<!-- -->5<!-- --> timeB@<!-- -->5</div><div class="flex flex-row"><div class="w-1/2 m-2 border border-gray-400 rounded p-2"><span class="text-3xl">ğŸŒ</span><span class="text-3xl">ğŸ¥‘</span><span class="text-3xl">ğŸ¥¦</span></div><div class="w-1/2 m-2 border border-red-400 rounded p-2"><span class="text-3xl">ğŸ‡</span><span class="text-3xl">ğŸ‰</span></div></div></div><p>The red box you see is what is often called a <em>tombstone</em> set. Many CRDTs use similar models.
Things that are removed are removed forever and tracked. This allows the merger of the data structure. 
User A and User B can know that whatever they removed will be gone when their states are combined.</p><p>Because items have been removed are never coming back, it doesnâ€™t matter when
the remove action occurred, only that at some point it did occur.</p></div></div></div></div>
    <script src="static/idyll_index.js"></script>
  </body>
</html>
